<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Motion Graph Auto Update</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { margin: 0; padding: 0; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center; height: 100vh; }
    #motionGraphContainer { width: 90%; border: 1px solid #ccc; background: #fff; }
  </style>
</head>
<body>
  <div id="motionGraphContainer">Loading motion graph...</div>
  <script>
    // SSE로 motion graph 업데이트를 수신
    const source = new EventSource("http://172.30.1.59:5000/motion_graph_stream");
    source.onmessage = function(event) {
      // 이벤트 메시지(업데이트 타임스탬프)를 받으면 해당 값(ts)을 이용해서 새 SVG 요청 (캐시 우회)
      const ts = event.data;
      fetch("http://172.30.1.59:5000/motion_graph?ts=" + ts)
        .then(response => response.text())
        .then(svg => {
          document.getElementById("motionGraphContainer").innerHTML = svg;
        })
        .catch(err => console.error("Error fetching motion graph:", err));
    };
    source.onerror = function(err) {
      console.error("SSE Error:", err);
    };
  </script>
</body>
</html>
